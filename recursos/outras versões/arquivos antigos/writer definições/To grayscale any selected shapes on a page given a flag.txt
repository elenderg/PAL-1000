To grayscale any selected shapes on a page given a flag:
If the page is nil, exit.
Loop.
Get a shape from the page's shapes.
If the shape is nil, exit.
If the shape is not selected, repeat.
Grayscale the shape given the flag.
Repeat.
