To find a free tab starting with a tab:
Privatize the tab.
Loop.
If the tab is nil, break.
If the tab is free, break.
Put the tab's next into the tab.
Repeat.
Put the tab into the free tab.
