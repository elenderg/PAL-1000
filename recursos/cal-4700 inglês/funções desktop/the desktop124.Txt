To handle a command (p):
Create a submenu.
Add "Paste" and "V" and "handle paste" to the submenu.
If the current tab's mode is "writer", add "Pen..." and "pen..." to the submenu.
If the current tab's mode is "editor", add "Print..." and "P" and "handle print" to the submenu.
If the current tab's mode is "docster", add "Print..." and "P" and "handle print" to the submenu.
If the current tab's mode is "writer", add "Print..." and "P" and "handle print" to the submenu.
Handle the command given the submenu.
