To decide if something is selected in a document:
If the document is nil, say no.
Loop.
Get a page from the document's pages.
If the page is nil, say no.
If the page is selected, say yes.
Repeat.
