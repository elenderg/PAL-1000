To select every shape on a page:
If the page is nil, exit.
Loop.
Get a shape from the page's shapes.
If the shape is nil, exit.
Select the shape.
Repeat.
