To duplicate any selected shapes on a page:
If the page is nil, exit.
Set the page's superduper's flag.
If the superduper of the page should be reset, reset the superduper given the page.
Loop.
Get a shape from the page's shapes.
If the shape is nil, break.
If the shape is not selected, repeat.
Copy the shape into another shape.
Append the other shape to some shapes.
Deselect the shape.
Select the other shape.
Move the other shape given the page's superduper's pair.
Repeat.
Append the shapes to the page's shapes.
