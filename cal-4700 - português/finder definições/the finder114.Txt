To save a node:
If the node is nil, exit.
If the node's source is not nil, save the node (source).
If the node's document is not nil, save the node (document).
