To handle an event given the dialog (undo):
If the dialog's text cannot be undone, cluck; exit.
Handle undo given the dialog's text.
Show the desktop.
