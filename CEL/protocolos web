Um query pedaço é um texto de consulta.
Um texto de consulta é uma string.

Etapas para que se read uma response string desde um winhttp request:
  Se o winhttp request for inexistente, cancele.
  Limpe a response string.
  Atribua 8 kilobytes a um trecho size.
  Percorra. [o código abaixo]
    Atribua 0 a um size.
    Call "winhttp.dll" "WinHttpqueryDataAvailable" com 
      O request número identificador deste winhttp request 
      e O endereçamento deste size 
      devolvendo um result número.
    Se o result número for 0, atribua "Erro. Não foi possível consultar os dados disponíveis." ao erro do fluxo de entrada/saída; limpe a response; break.
    Atribua a quantidade de caracteres desta response a uma quantidade de caracteres armazenados.
    Reassign o first desta response string usando a quantidade de caracteres armazenados mais o trecho size.
    Atribua o first desta response string mais a quantidade de caracteres armazenados a um endereço de memória.
    Call "winhttp.dll" "WinHttpReadData" com 
      O request número identificador deste winhttp request 
      e O endereço de memória 
      e O trecho size 
      e O endereçamento dessa contagem 
      devolvendo o result número.
    Se o result número for 0, atribua "Ocorreu um erro na hora de ler os dados." ao erro do fluxo de entrada/saída; limpe o response; break.
    Atribua o endereço de memória mais a contagem menos 1 ao last desta response string.
    Se a contagem for 0, pare.
  Repita. [o código acima]

Etapas para que se read um URL para um trecho:
  \ prepare
  Limpe o trecho.
  Limpe o erro do fluxo de entrada/saída.
  \ internet abra
  Call "wininet.dll" "InternetOpenA" com 
    O first deste nome deste module 
    e 0 [INTERNET_OPEN_TYPE_PRECONFIG] 
    e nil 
    e nil 
    devolvendo um internet número identificador.
  Se o internet número identificador for 0, atribua "Erro. Não foi possível se conectar à internet. Verifique sua conexão" ao erro do fluxo de entrada/saída; exit.
 \ internet abra URL
  Isole a URL.
  Modifique através do caractere NUL a URL.
  Call "wininet.dll" "InternetOpenUrlA" com 
    O internet número identificador 
    e O first desta URL 
    e nil 
    e 0 
    e 0 
    e 0 
    devolvendo um URL número identificador.
  Se o URL número identificador for 0, atribua "Erro. Não foi possível acessar a URL: " junto com o URL seguido de "." ao erro do fluxo de entrada/saída; call "wininet.dll" "InternetCloseHandle" com o internet número identificador; exit.
  \ read o file
  Atribua 64 kilobytes a um trecho size.
  Percorra. [o código abaixo]
    Atribua a quantidade de caracteres deste trecho a uma quantidade de caracteres armazenados.
    Reassign o first endereço de memória do pedaço deste trecho usando a quantidade de caracteres armazenados mais o trecho size.
    Atribua o first endereço de memória do pedaço deste trecho mais a quantidade de caracteres armazenados a um endereço de memória.
    Call "wininet.dll" "InternetReadFile" com 
      O URL número identificador 
      e O endereço de memória 
      e O trecho size 
      e O endereçamento dessa contagem 
      devolvendo um result número.
    Se o result número for 0, atribua "Ocorreu um erro na hora de ler a URL: " junto com o URL seguido de "." ao erro do fluxo de entrada/saída; break.
    Atribua o endereço de memória mais a contagem menos 1 ao last endereço de memória do pedaço deste trecho.
    Se a contagem for 0, pare.
  Repita. [o código acima]
  \ clean para cima
  Call "wininet.dll" "InternetCloseHandle" com 
    O URL número identificador.
  Call "wininet.dll" "InternetCloseHandle" com 
    O internet número identificador.

Etapas para que se receive o response desde um winhttp request:
  Se o winhttp request for inexistente, cancele.
  Call "winhttp.dll" "WinHttpReceiveResponse" com
    A request número identificador deste winhttp request
    e 0
    devolvendo um result número.
  Se o result número for 0, atribua "A solicitação não pode ser enviada." ao erro do fluxo de entrada/saída; exit.

Etapas para que se receive um trecho desde um socket:
  Limpe o erro do fluxo de entrada/saída.
  Limpe o trecho.
  Atribua 8 kilobytes a um trecho size.
  Percorra. [o código abaixo]
    Atribua 0 a um size.
    Atribua a quantidade de caracteres deste trecho a uma quantidade de caracteres armazenados.
    Reassign o first endereço de memória do pedaço deste trecho usando a quantidade de caracteres armazenados mais o trecho size.
    Atribua o first endereço de memória do pedaço deste trecho mais a quantidade de caracteres armazenados a um endereço de memória.
    Call "ws2_32.dll" "recv" com
      O socket 
      e O endereço de memória 
      e O trecho size 
      e 0 
      devolvendo uma contagem.
    Se a contagem não for -1 [SOCKET_ERROR], atribua o endereço de memória mais a contagem menos 1 ao last endereço de memória do pedaço deste trecho; exit.
    Se o last winsock erro do system não for 10040 [WSAMSGSIZE], atribua "Ocorreu um erro no recebimento dos dados." ao erro do fluxo de entrada/saída; limpe o trecho; exit.
  \Se o last winsock erro desse system não for 10040 [WSAMSGSIZE], atribua "Ocorreu um erro no recebimento dos dados." ao erro do fluxo de entrada/saída; limpe o trecho; exit.
    Atribua o endereço de memória mais a contagem menos 1 ao last endereço de memória do pedaço deste trecho.
  Repita. [o código acima]

Etapas para que se post um data string para um URL e receive um response string:
  \ only works com http e https
  Limpe o response.
  Limpe o erro do fluxo de entrada/saída.
  Crie um winhttp request por posting para o URL.
  Se o erro do fluxo de entrada/saída não estiver em branco, cancele.
  Send o data para o winhttp request.
  Se o erro do fluxo de entrada/saída não estiver em branco, destrua o winhttp request; exit.
  Receive o response desde o winhttp request.
  Se o erro do fluxo de entrada/saída não estiver em branco, destrua o winhttp request; exit.
  Read o response desde o winhttp request.
  Se o erro do fluxo de entrada/saída não estiver em branco, destrua o winhttp request; exit.
  Destrua o winhttp request.


















